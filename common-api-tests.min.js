const COMMON={ERROR:{OFFSET:3},TYPE_ERROR:{MESSAGE:"Wrong argument type for function"},RANGE_ERROR:{MESSAGE:"Argument out of range for function"},SCRIPT_INTERRUPTED:{MESSAGE:"FAILED: Script interrupted due to a server error or an auth error"}};function testCommon(e,r,t,n){logResponseBody(),e&&checkStatusCode(e),pm.response.code===e&&(r&&checkContentType(r),t&&checkJSONSchema(t),n&&checkLocation(n))}function testCommonAndTime(e,r,t,n,o){testCommon(e,t,n,o),pm.response.code===e&&r&&checkTime(r)}function logResponseBody(){const e=pm.response.text();if(e&&!/^504|401|403$/.test(pm.response.code))try{JSON.parse(e),pm.test(`Response Body: ${e}`,()=>{})}catch(e){console.log("Response body is not valid JSON")}else pm.test(`Response Body: ${e}`,()=>{})}function getType(e){return Object.prototype.toString.call(e).replace(/^\[object |\]$/g,"")}function getFunctionNameFromInside(e){if("Error"===getType(e)){let r=e.stack.split(/\r\n|\r|\n/g)[1].trim();return r=r.substr(COMMON.ERROR.OFFSET,r.indexOf("(")-1-COMMON.ERROR.OFFSET)}throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} getFunctionNameFromInside`)}function getIndexObjectInArray(e,r,t){if(Array.isArray(e)&&e.every(e=>"Object"===getType(e))&&"String"===getType(r))return e.findIndex(e=>e[r]===t);throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}function convertTime(e){if("Number"===getType(e))return e>=1e3?`${e/1e3}s`:`${e}ms`;throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}function delayTime(e){if("Number"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);console.log(`Delaying for ${convertTime(e)}...`),setTimeout(()=>console.log("Delay finished"),e)}function generateNumber(e,r){if("Number"===getType(e)&&"Number"===getType(r)){if(e<=r)return Math.floor(Math.random()*(r-e+1)+e);throw new RangeError(`${COMMON.RANGE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}function generateString(e){if("Number"===getType(e)){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let t="";for(let n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}function checkTime(e){if("Number"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);if(!(e>0))throw new RangeError(`${COMMON.RANGE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);pm.test(`Response Time < ${convertTime(e)}`,()=>{pm.expect(pm.response.responseTime).to.be.below(e)})}function checkStatusCode(e){if("Number"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);{const r=[503,500,502,504,401,403];let t="Status Code ";switch(!0){case 100<=e&&e<=199:t+="(Information)";break;case 200<=e&&e<=299:t+="(Success)";break;case 300<=e&&e<=399:t+="(Redirection)";break;case 400<=e&&e<=499:t+="(Client Error)";break;case 500<=e&&e<=599:t+="(Server Error)";break;default:throw new RangeError(`${COMMON.RANGE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}if(pm.test(t,()=>{pm.response.to.have.status(e)}),pm.response.code!=e)for(let e=0;e<r.length;e++)if(pm.response.code===r[e]){postman.setNextRequest(null),console.log(COMMON.SCRIPT_INTERRUPTED.MESSAGE);break}}}function checkContentType(e){if("String"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);pm.test("Content Type",()=>{pm.response.to.have.header("Content-Type"),pm.expect(pm.response.headers.get("Content-Type")).to.include(e)})}function checkJSONSchema(e){if("Object"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);{const r=tv4.validate(pm.response.json(),e),t=r?"JSON Schema":`JSON Schema (${tv4.error.message} for data path ${tv4.error.dataPath?tv4.error.dataPath:"/"})`;pm.test(t,()=>{pm.expect(r).to.be.true})}}function checkLocation(e){if("String"!==getType(e))throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`);pm.test("Location",()=>{pm.response.to.be.header("Location",e)})}function getRegexGUID(){return"^(?!00000000-0000-0000-0000-000000000000)([0-9a-zA-Z]{8}-[0-9a-zA-Z]{4}-[0-9a-zA-Z]{4}-[0-9a-zA-Z]{4}-[0-9a-zA-Z]{12})$"}function getRegexISODateTime(){return"^(?!0001-01-01T00:00:00Z)([0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}.?[0-9]*Z)$"}function getRegexURL(){return"^https?://[0-9a-zA-Z-]+\\.[0-9a-zA-Z-]+|https?://localhost"}function getSchemaHAL(e={}){if("Object"===getType(e))return{type:"object",required:["_links","_embedded","_page"],properties:{_links:{type:"object",required:["self","first","last"],properties:{self:{type:"object",required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}},next:{type:["object","null"],required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}},previous:{type:["object","null"],required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}},first:{type:"object",required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}},last:{type:"object",required:["href"],properties:{href:{type:"string",pattern:getRegexURL()}}}}},_embedded:{type:"object",required:["resourceList"],properties:{resourceList:{type:"array",items:e}}},_page:{type:"object",required:["size","number"],properties:{size:{type:"number",minimum:0,multipleOf:1},totalElements:{type:"number",minimum:0,multipleOf:1},totalPages:{type:"number",minimum:0,multipleOf:1},number:{type:"number",minimum:1,multipleOf:1}}}}};throw new TypeError(`${COMMON.TYPE_ERROR.MESSAGE} ${getFunctionNameFromInside(new Error)}`)}